{% extends 'base3.html.twig' %}

{% block body %}

<div class="form-container">

  <h1>Ajouter un Programme pour l'hébergement : {{ hebergement.nom }}</h1>

  {{ form_start(form, {'attr': {'novalidate': 'novalidate'}}) }}

  <div class="form-group">
      {{ form_label(form.nom) }}
      {{ form_widget(form.nom, {'attr': {'class': 'form-control', 'id': 'programme_nom'}}) }}
      <div class="error-message">
          {{ form_errors(form.nom) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.lieu) }}
      {{ form_widget(form.lieu, {'attr': {'class': 'form-control', 'id': 'programme_lieu'}}) }}
      <div class="error-message">
          {{ form_errors(form.lieu) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.dateDebut) }}
      {{ form_widget(form.dateDebut, {'attr': {'class': 'form-control', 'id': 'programme_dateDebut'}}) }}
      <div class="error-message">
          {{ form_errors(form.dateDebut) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.dateFin) }}
      {{ form_widget(form.dateFin, {'attr': {'class': 'form-control', 'id': 'programme_dateFin'}}) }}
      <div class="error-message">
          {{ form_errors(form.dateFin) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.description) }}
      {{ form_widget(form.description, {'attr': {'class': 'form-control', 'id': 'programme_description'}}) }}
      <div class="error-message">
          {{ form_errors(form.description) }}
      </div>
  </div>

  <button type="submit" class="btn btn-success">Ajouter</button>

  {{ form_end(form) }}
</div>


<script>
  document.addEventListener('DOMContentLoaded', function() {
      const form = document.querySelector('form');
      form.addEventListener('submit', function(event) {
          let errors = [];

          const nom = document.querySelector('#programme_nom');
          const lieu = document.querySelector('#programme_lieu');
          const dateDebut = document.querySelector('#programme_dateDebut');
          const dateFin = document.querySelector('#programme_dateFin');
          const description = document.querySelector('#programme_description');

          const errorElements = document.querySelectorAll('.error-message');
          errorElements.forEach(function(element) {
              element.innerHTML = '';
          });

          if (nom.value.length < 5) {
              errors.push({ field: 'nom', message: "Le nom doit contenir au moins 5 caractères." });
          }

          if (lieu.value === '') {
              errors.push({ field: 'lieu', message: "Le lieu doit être rempli." });
          }

          if (!dateDebut.value) {
              errors.push({ field: 'dateDebut', message: "La date de début est requise." });
          }

          if (!dateFin.value) {
              errors.push({ field: 'dateFin', message: "La date de fin est requise." });
          }

          if (description.value.length < 10) {
              errors.push({ field: 'description', message: "La description doit contenir au moins 10 caractères." });
          }

          if (errors.length > 0) {
              event.preventDefault();
              errors.forEach(function(error) {
                  const errorContainer = document.querySelector(`#programme_${error.field}`).parentNode.querySelector('.error-message');
                  if (errorContainer) {
                      errorContainer.innerHTML = error.message;
                  }
              });
          }
      });
  });
</script>

{% endblock %}
