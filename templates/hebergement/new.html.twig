{% extends 'base3.html.twig' %}

{% block body %}
<div class="form-container">
  <h1>Créer un nouvel Hébergement</h1>

  {{ form_start(form, {'attr': {'enctype': 'multipart/form-data'}}) }}

  <div class="form-group">
      {{ form_label(form.nom) }}
      {{ form_widget(form.nom, {'attr': {'class': 'form-control', 'id': 'hebergement_nom'}}) }}
      <div class="error-message">
          {{ form_errors(form.nom) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.type) }}
      {{ form_widget(form.type, {'attr': {'class': 'form-control', 'id': 'hebergement_type'}}) }}
      <div class="error-message">
          {{ form_errors(form.type) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.adresse) }}
      {{ form_widget(form.adresse, {'attr': {'class': 'form-control', 'id': 'hebergement_adresse'}}) }}
      <div class="error-message">
          {{ form_errors(form.adresse) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.capacite) }}
      {{ form_widget(form.capacite, {'attr': {'class': 'form-control', 'id': 'hebergement_capacite'}}) }}
      <div class="error-message">
          {{ form_errors(form.capacite) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.description) }}
      {{ form_widget(form.description, {'attr': {'class': 'form-control', 'id': 'hebergement_description'}}) }}
      <div class="error-message">
          {{ form_errors(form.description) }}
      </div>
  </div>

  <div class="form-group">
      {{ form_label(form.image) }}
      {{ form_widget(form.image, {'attr': {'class': 'form-control', 'id': 'hebergement_image'}}) }}
      <div class="error-message">
          {{ form_errors(form.image) }}
      </div>
  </div>

  <button type="submit" class="btn btn-success">Créer</button>

  {{ form_end(form) }}
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
      const form = document.querySelector('form');
      form.addEventListener('submit', function(event) {
          let errors = [];

          const nom = document.querySelector('#hebergement_nom');
          const type = document.querySelector('#hebergement_type');
          const adresse = document.querySelector('#hebergement_adresse');
          const capacite = document.querySelector('#hebergement_capacite');
          const description = document.querySelector('#hebergement_description');
          const image = document.querySelector('#hebergement_image');

          // Effacer les erreurs affichées
          const errorElements = document.querySelectorAll('.error-message');
          errorElements.forEach(function(element) {
              element.innerHTML = '';
          });

          // Validation des champs
          if (nom.value.length < 5) {
              errors.push({ field: 'nom', message: "Le nom doit contenir au moins 5 caractères." });
          }

          if (type.value === '') {
              errors.push({ field: 'type', message: "Le type doit être sélectionné." });
          }

          if (adresse.value.length < 10) {
              errors.push({ field: 'adresse', message: "L'adresse doit contenir au moins 10 caractères." });
          }

          if (capacite.value <= 0) {
              errors.push({ field: 'capacite', message: "La capacité doit être supérieure à 0." });
          }

          if (description.value.length < 10) {
              errors.push({ field: 'description', message: "La description doit contenir au moins 10 caractères." });
          }

          if (image.files.length === 0) {
              errors.push({ field: 'image', message: "Veuillez télécharger une image." });
          }

          // Si des erreurs existent, les afficher devant les champs
          if (errors.length > 0) {
              event.preventDefault(); // Bloquer la soumission du formulaire

              errors.forEach(function(error) {
                  const errorContainer = document.querySelector(`#hebergement_${error.field}`).parentNode.querySelector('.error-message');
                  if (errorContainer) {
                      errorContainer.innerHTML = error.message;
                  }
              });
          }
      });
  });
</script>

{% endblock %}
